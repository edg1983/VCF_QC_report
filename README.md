# QC reports for variants

Set of R markdown to generate an html QC report for small variants and structural variants VCF.

## How to generate the reports

1. Put the input files with the named as indicated below in th same folder with the .Rmd files
2. Generate HTML reports using

```
R -e "rmarkdown::render('QC_report_SV.Rmd', output_file='report_SV.html')"
R -e "rmarkdown::render('QC_report_smallvars.Rmd', output_file='report_smallvars.html')"
```
## Input for small variants
- **VCF.stats**: stats generated using `bcftools stats -s-`
- **VCF_varsPerChrom.stats**: count of variants per chromosome generated using `bcftools index --stats`
- **ancestry.tsv** file generated by `somalier ancestry`

## Input for SV variants
- **SV_per_sample_info.tsv**: Per sample data generated with

```
bcftools query -i 'FILTER == "PASS"' -f '[%CHROM\t%POS\t%SVTYPE\t%SVLEN\t%AF\t%SAMPLE\t%GT\t%SQ\t%DP\t%CN\n]' input_vcf.vcf.gz >
```

- **SV_per_variant_info.tsv**: Per variant data generated with

```
bcftools query -i 'FILTER == "PASS"' -H -f '%CHROM\t%POS\t%ID\t%FILTER\t%SVTYPE\t%SVLEN\t%CIPOS95\t%AF\n' input_vcf.vcf.gz > SV_
```

## Dependencies
- ggplot2
- dplyr
- tidyr
- knitr
- patchwork
